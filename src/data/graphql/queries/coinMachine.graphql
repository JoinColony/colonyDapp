# Coin Machine Extension
#
#

query CoinMachineSaleTokens($colonyAddress: String!) {
  coinMachineSaleTokens(colonyAddress: $colonyAddress) @client {
    sellableToken {
      address
      decimals
      symbol
      name
    }
    purchaseToken {
      address
      decimals
      symbol
      name
    }
  }
}

query CoinMachineCurrentPeriodPrice($colonyAddress: String!) {
  coinMachineCurrentPeriodPrice(colonyAddress: $colonyAddress) @client
}

query CoinMachineBoughtTokens($colonyAddress: String!, $transactionHash: String!) {
  coinMachineBoughtTokens(colonyAddress: $colonyAddress, transactionHash: $transactionHash) @client {
    numTokens
    totalCost
  }
}

query CoinMachineTransactionAmount($colonyAddress: String!, $transactionHash: String!) {
  coinMachineTransactionAmount(colonyAddress: $colonyAddress, transactionHash: $transactionHash) @client {
    transactionAmount
    transactionSucceed
  }
}

query CoinMachineCurrentPeriodMaxUserPurchase($userAddress: String!, $colonyAddress: String!) {
  coinMachineCurrentPeriodMaxUserPurchase(userAddress: $userAddress, colonyAddress: $colonyAddress) @client
}

query CoinMachineCurrentSalePeriod($colonyAddress: String!) {
  coinMachineCurrentSalePeriod(colonyAddress: $colonyAddress) @client {
    periodLength
    timeRemaining
  }
}

query CurrentPeriodTokens($colonyAddress: String!) {
  currentPeriodTokens(colonyAddress: $colonyAddress) @client {
    maxPerPeriodTokens
    activeSoldTokens
    targetPerPeriodTokens
  }
}

query CoinMachineTokenBalance($colonyAddress: String!) {
  coinMachineTokenBalance(colonyAddress: $colonyAddress) @client
}

query SubgraphCoinMachinePeriods($colonyAddress: String!) {
  coinMachinePeriods(
    where: { colonyAddress: $colonyAddress },
    skip: 1,
    orderBy: "saleEndedAt",
    orderDirection: "desc"
  ) {
    saleEndedAt
    tokensBought
    price
  }
}

query CoinMachineSalePeriods($colonyAddress: String!, $limit: Int!) {
  coinMachineSalePeriods(colonyAddress: $colonyAddress, limit: $limit) @client {
    saleEndedAt
    tokensBought
    price
  }
}

